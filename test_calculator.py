"""Модуль тестов для калькулятора."""

from calc import infix_to_rpn, evaluate_rpn


def test_calculator_functions():
    """Выполняет все тесты калькулятора."""
    tests = [
        (
            "3 + 4 * 2",
            ["3", "4", "2", "*", "+"],
            11.0
        ),
        (
            "(3 + 4) * 2",
            ["3", "4", "+", "2", "*"],
            14.0
        ),
        (
            "10 + 2 * 6",
            ["10", "2", "6", "*", "+"],
            22.0
        ),
        (
            "100 * 2 + 12",
            ["100", "2", "*", "12", "+"],
            212.0
        ),
        (
            "100 * ( 2 + 12 )",
            ["100", "2", "12", "+", "*"],
            1400.0
        ),
        (
            "100 * ( 2 + 12 ) / 14",
            ["100", "2", "12", "+", "*", "14", "/"],
            100.0
        ),
        # Новые тесты для третьего уровня
        (
            "2 ^ 3",
            ["2", "3", "^"],
            8.0
        ),
        (
            "2 ^ 3 ^ 2",
            ["2", "3", "2", "^", "^"],
            512.0
        ),
        (
            "-5 + 3",
            ["0", "5", "-", "3", "+"],
            -2.0
        ),
        (
            "+5 - -3",
            ["5", "0", "3", "-", "-"],
            8.0
        ),
        (
            "2 * -3",
            ["2", "0", "3", "-", "*"],
            -6.0
        ),
        (
            "(2 + 3) ^ 2",
            ["2", "3", "+", "2", "^"],
            25.0
        )
    ]

    for expr, expected_rpn, expected_result in tests:
        rpn_result = infix_to_rpn(expr)
        assert rpn_result == expected_rpn, f"Ожидалось {expected_rpn}, но {rpn_result}"
        result = evaluate_rpn(rpn_result)
        assert abs(result - expected_result) < 1e-9, \
            f"Ожидалось {expected_result}, но {result}"


if __name__ == "__main__":
    test_calculator_functions()
    print("Все тесты пройдены!")